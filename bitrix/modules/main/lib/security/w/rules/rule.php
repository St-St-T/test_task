<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1191469339']= array(base64_decode('aXN'.'fc3RyaW'.'5n'),base64_decode('c3'.'R'.'ydG9sb3'.'dlcg=='),base64_decode('aX'.'NfYXJyYXk'.'='),base64_decode('aXNfc'.'3RyaW5n'),base64_decode('Z3pkZWNvZGU='),base64_decode('Y'.'mFzZ'.'TY0'.'X2RlY29'.'kZQ=='),base64_decode('dXJsZGVjb'.'2'.'Rl'),base64_decode('YXJyYXlfcmV2ZXJzZQ=='),base64_decode('Z3pl'.'bmNvZG'.'U'.'='),base64_decode('YmFz'.'ZTY0X2Vu'.'Y2'.'9'.'kZ'.'Q='.'='),base64_decode('dXJsZW5'.'jb'.'2Rl'),base64_decode(''.'YmluMm'.'hleA=='),base64_decode('aXNfYX'.'JyYXk='),base64_decode('c3RydG9'.'sb'.'3d'.'lcg=='),base64_decode('a'.'XNfYXJyYX'.'k='),base64_decode('am9pb'.'g=='),base64_decode('Zm5tYXRjaA=='),base64_decode(''.'cmF3dXJ'.'sZGVjb2'.'Rl'),base64_decode('c'.'3Vic3Ry'),base64_decode('c3'.'Vic3Ry'),base64_decode('c'.'3'.'Ry'.'X3JlcGxhY2U='),base64_decode('cHJlZ1'.'9xdW90'.'ZQ=='),base64_decode('cH'.'JlZ19tYXRj'.'aA=='));if(!function_exists(__NAMESPACE__.'\\___275609374')){function ___275609374($_1277404638){static $_1782325200= false; if($_1782325200 == false) $_1782325200=array('YWN'.'0aW9u','aW50dm'.'Fs','cGF0aA==',''.'Y29udGV4'.'d'.'A==','a2V5cw==',''.'c'.'HJvY2Vzcw'.'='.'=','ZW5jb2Rp'.'bm'.'c=','cH'.'JlZ19y'.'ZXBsY'.'W'.'Nl','c'.'GF0a'.'A'.'='.'=',''.'Y29'.'udGV4d'.'A==','a2V5cw'.'==','cHJ'.'v'.'Y2'.'Vzcw==',''.'ZW5'.'jb2'.'Rpbmc=','cGF0dG'.'Vybg'.'==','cHJlZ19tYXRjaA='.'=','c'.'GF0'.'aA==','Y29u'.'dG'.'V4d'.'A='.'=','a2V5'.'cw==',''.'c'.'HJv'.'Y2V'.'zcw==','Z'.'W5j'.'b'.'2R'.'pbmc=','c'.'GF0dGVyb'.'g==','cG9zdF'.'9h'.'Y3Rpb2'.'4=','Y2hlY2'.'tfY3NyZg==','cGF0aA==',''.'Y29udGV4'.'dA==','a2V5cw==',''.'cHJ'.'vY2Vz'.'cw==','ZW5jb2'.'Rp'.'bmc'.'=','cG'.'F0'.'dGVybg==','Y'.'WN'.'0aW9u','YWN0aW9'.'u','YWN0'.'aW9u',''.'Y'.'WN0aW9u','Y'.'WN0aW9'.'u','YWN0aW9u','cG9zdF9'.'hY3Rpb24=','Z'.'W5j'.'b2Rpbmc=',''.'ZW'.'5jb'.'2Rp'.'bmc=','Z'.'W5jb2Rpbmc=',''.'ZW5jb'.'2Rpbmc=','ZW'.'5'.'jb2Rpbmc=','ZW5jb2R'.'pbmc=','Z'.'3o=','Y'.'mFzZT'.'Y0','dXJs',''.'aGV4','Lg==','Lw='.'=',''.'aW5kZXg'.'ucGhw',''.'L2luZ'.'GV4L'.'nBocA==',''.'U'.'0NSSVBU'.'X'.'05'.'BTU'.'U=',''.'L2'.'lu'.'Z'.'GV4'.'LnBocA==','U0NS'.'SVBUX'.'0'.'5'.'BT'.'UU=','U0NSS'.'VB'.'UX0'.'5BT'.'UU=','U0'.'NSSV'.'BUX05'.'BT'.'UU=','fg==','fl4'.'=','fg==','X'.'H4=','JH'.'4=');return base64_decode($_1782325200[$_1277404638]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1666178896; protected $_265951148; protected $_1494562735; protected $_67395594; protected $_1239181825; public static function make(array $_605841187):?static{ $_605841187= static::prepareRuleParameters($_605841187); return match($_605841187[___275609374(0)]){ ___275609374(1) => new IntvalRule( $_605841187[___275609374(2)], $_605841187[___275609374(3)], $_605841187[___275609374(4)], $_605841187[___275609374(5)], $_605841187[___275609374(6)]), ___275609374(7) => new PregReplaceRule( $_605841187[___275609374(8)], $_605841187[___275609374(9)], $_605841187[___275609374(10)], $_605841187[___275609374(11)], $_605841187[___275609374(12)], $_605841187[___275609374(13)]), ___275609374(14) => new PregMatchRule( $_605841187[___275609374(15)], $_605841187[___275609374(16)], $_605841187[___275609374(17)], $_605841187[___275609374(18)], $_605841187[___275609374(19)], $_605841187[___275609374(20)], $_605841187[___275609374(21)]), ___275609374(22) => new CsrfRule( $_605841187[___275609374(23)], $_605841187[___275609374(24)], $_605841187[___275609374(25)], $_605841187[___275609374(26)], $_605841187[___275609374(27)], $_605841187[___275609374(28)],), default => null,};} protected static function prepareRuleParameters(array $_162297851): array{ if($GLOBALS['____1191469339'][0]($_162297851[___275609374(29)])){ $_162297851[___275609374(30)]= $GLOBALS['____1191469339'][1]($_162297851[___275609374(31)]);} elseif($GLOBALS['____1191469339'][2]($_162297851[___275609374(32)])){ $_151913353= $_162297851[___275609374(33)]; $_162297851[___275609374(34)]= $_151913353[(1100/2-550)]; $_162297851[___275609374(35)]= $_151913353[round(0+1)];} $_162297851[___275609374(36)]=!empty($_162297851[___275609374(37)])? $_162297851[___275609374(38)]:[]; if($GLOBALS['____1191469339'][3]($_162297851[___275609374(39)])){ $_162297851[___275609374(40)]=[$_162297851[___275609374(41)]];} return $_162297851;}  public function __construct($_1666178896, $_265951148, $_1494562735, $_67395594, $_1239181825){ $this->_1666178896= $_1666178896; $this->_265951148= $this->castContext($_265951148); $this->_1494562735= $this->castKeys($_1494562735); $this->_67395594= $_67395594; $this->_1239181825= $_1239181825;} public function evaluateValue($_1021770773){ if(!empty($this->_1239181825)){ foreach($this->_1239181825 as $_2105380253){ $_1021770773= match($_2105380253){ 'gz' => $GLOBALS['____1191469339'][4]($_1021770773), 'base64' => $GLOBALS['____1191469339'][5]($_1021770773), 'url' => $GLOBALS['____1191469339'][6]($_1021770773), 'hex' => hex2bin($_1021770773)};}} $_464151000= $this->evaluate($_1021770773); if(!empty($this->_1239181825) && $_464151000 instanceof ModifyResult){ $_276381863= $_464151000->getCleanValue(); foreach($GLOBALS['____1191469339'][7]($this->_1239181825) as $_2105380253){ $_276381863= match($_2105380253){ ___275609374(42) => $GLOBALS['____1191469339'][8]($_276381863), ___275609374(43) => $GLOBALS['____1191469339'][9]($_276381863), ___275609374(44) => $GLOBALS['____1191469339'][10]($_276381863), ___275609374(45) => $GLOBALS['____1191469339'][11]($_276381863)};} $_464151000= new ModifyResult($_276381863);} return $_464151000;} abstract public function evaluate($_1021770773); protected function castContext($_265951148){ if(!$GLOBALS['____1191469339'][12]($_265951148)){ $_265951148=[$_265951148];} foreach($_265951148 as $_1808158207 => $_3005802){ $_265951148[$_1808158207]= $GLOBALS['____1191469339'][13]($_3005802);} return $_265951148;} protected function castKeys($_1494562735){ if(!$GLOBALS['____1191469339'][14]($_1494562735)){ $_1494562735=[$_1494562735];} return $_1494562735;} public function matchKey(array $_41544317): bool{ $_41544317= $GLOBALS['____1191469339'][15](___275609374(46), $_41544317); foreach($this->_1494562735 as $_1537272162){   if($GLOBALS['____1191469339'][16]($_1537272162, $_41544317)){ return true;}} return false;}  public function matchPath($_1434509325){ if($this->_1666178896 === '*'){ return true;}  $_828870528= new Uri($_1434509325); $_1975849828= $_828870528->getPath(); $_1975849828= $GLOBALS['____1191469339'][17]($_1975849828);      if(str_ends_with($_1975849828, ___275609374(47))){ $_1975849828 .= ___275609374(48);} $_1975849828= Path::normalize($_1975849828);  $_1937540788[]= $_1975849828; if(str_ends_with($_1975849828, ___275609374(49))){ $_1937540788[]= $GLOBALS['____1191469339'][18]($_1975849828,(210*2-420),-round(0+3+3+3));} elseif(str_ends_with($_SERVER[___275609374(50)], ___275609374(51))){ $_1937540788[]= $GLOBALS['____1191469339'][19]($_SERVER[___275609374(52)],(858-2*429),-round(0+2.25+2.25+2.25+2.25));} if($_1975849828 !== $_SERVER[___275609374(53)]){ $_1937540788[]= $_SERVER[___275609374(54)];}  if(str_starts_with($this->_1666178896, ___275609374(55))){ $_1393909461= $this->_1666178896;} else{ $_1393909461= ___275609374(56). $GLOBALS['____1191469339'][20](___275609374(57), ___275609374(58), $GLOBALS['____1191469339'][21]($this->_1666178896)). ___275609374(59);} foreach($_1937540788 as $_897169064){ if($this->_1666178896 === $_897169064 || $GLOBALS['____1191469339'][22]($_1393909461, $_897169064)){ return true;}} return false;}  public function getPath(){ return $this->_1666178896;}  public function getContext(){ return $this->_265951148;}  public function getKeys(){ return $this->_1494562735;}  public function getProcess(){ return $this->_67395594;}}?>